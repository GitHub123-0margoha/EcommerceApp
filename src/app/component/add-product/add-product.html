<div class="container mt-4">
  <h2>Add New Product</h2>

  <form (ngSubmit)="editMode ? updatePrd() : addNewPrd()" #addNewPrdForm="ngForm">

    <div class="form-group mb-3">
      <label>Product Name</label>
      <input type="text" class="form-control" pattern="^[a-zA-Z ]{3,15}$" [(ngModel)]="newPrd.name" name="name" required #prdName="ngModel">
      @if(prdName.invalid && (prdName.dirty || prdName.touched)) {
        <div class="text-danger">
          @if(prdName.errors?.['required']) {
            <p>Name Is Required</p>
          }
          @if(prdName.errors?.['pattern']) {
            <p>Name Must Be 3 to 15 Characters Long</p>
          }
        </div>
      }
    </div>

    <div class="form-group mb-3">
      <label>Price</label>
      <input type="number" class="form-control" [(ngModel)]="newPrd.price" name="price" required min="1" #prdPrice="ngModel">
      @if (prdPrice.invalid && (prdPrice.dirty || prdPrice.touched)) {
        <div class="text-danger">
          @if (prdPrice.errors?.['required']) {
            <p>Price Is Required</p>
          }
          @if (prdPrice.errors?.['min']) {
            <p>Price Must Be More Than 0</p>
          }
        </div>
      }
    </div>

    <div class="form-group mb-3">
      <label>Quantity</label>
      <input type="number" class="form-control" [(ngModel)]="newPrd.quantity" name="quantity" required min="1" #prdQuantity="ngModel">
      @if (prdQuantity.invalid && (prdQuantity.dirty || prdQuantity.touched)) {
        <div class="text-danger">
          @if (prdQuantity.errors?.['required']) {
            <p>Quantity Is Required</p>
          }
          @if (prdQuantity.errors?.['min']) {
            <p>Quantity Must Be More Than 0</p>
          }
        </div>
      }
    </div>

    <div class="form-group mb-3">
      <label>Category</label>
      <select class="form-control" [(ngModel)]="newPrd.catId" name="catId" required #prdCatId="ngModel">
        <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
      </select>
      @if (prdCatId.invalid && (prdCatId.dirty || prdCatId.touched)) {
        <div class="text-danger">
          @if (prdCatId.errors?.['required']) {
            <p>Category Is Required</p>
          }
        </div>
      }
    </div>

    <div class="form-group mb-3">
      <label>Image</label>
      <input type="file" class="form-control" (change)="onImageSelected($event)"  accept="image/*">
    </div>

    <div class="form-group mb-3" *ngIf="newPrd.imgUrl">
      <img [src]="newPrd.imgUrl" alt="Image Preview" width="150" height="150" style="object-fit: cover; border-radius: 8px;">
    </div>

    <button type="submit" [disabled]="addNewPrdForm.invalid" class="btn btn-success">{{editMode? 'Update Product' : 'Add Product'}}</button>
  </form>
</div>
